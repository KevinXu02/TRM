# Experiment 4: TRM with Hybrid Gating (Both Inner and Outer Loops)
name: recursive_reasoning.trm_gated_hybrid@TRMHybridGated

loss:
  name: losses@ACTLossHead
  loss_type: stablemax_cross_entropy

halt_exploration_prob: 0.1
halt_max_steps: 16

H_cycles: 3
L_cycles: 6

H_layers: 0
L_layers: 2

hidden_size: 512
num_heads: 8
expansion: 4

puzzle_emb_ndim: ${.hidden_size}

pos_encodings: rope
forward_dtype: bfloat16

mlp_t: False
puzzle_emb_len: 16
no_ACT_continue: True

# ==================== NEW PARAMETERS ====================
# Inner loop: Qwen3-style attention gating
attention_gate_mode: elementwise  # Options: 'headwise', 'elementwise', 'none'

# Outer loop: GRU-style recurrence gating
recurrence_gate_use_reset: False  # False: simple, True: full GRU
# ========================================================